{"version":3,"file":"index.js","sources":["../src/enum/index.ts","../src/index.ts"],"sourcesContent":["\r\n//字典 Dictionaries    expire过期时间key    permanent永久不过期\r\nexport enum Dictionaries {\r\n    expire = '__expire__',\r\n    permanent = 'permanent'\r\n}","//expire  过期时间key permanent 永久不过期\r\nimport { StorageCls, Str, Expire, Date, Result } from \"./type\";\r\nimport { Dictionaries } from \"./enum\";\r\nexport class Storage implements StorageCls {\r\n    //获取localStorage\r\n    get<T>(key: Str): Result<T | null> {\r\n        const value = localStorage.getItem(key)\r\n        if (value) {\r\n            const data: Date<T> = JSON.parse(value);\r\n            const now = new Date().getTime();\r\n            //有效并且是数组类型 并且过期了 进行删除和提示\r\n            if (typeof data[Dictionaries.expire] == 'number' && data[Dictionaries.expire] < now) {\r\n                this.remove(key)\r\n                return {\r\n                    message: `您的${key}已过期`,\r\n                    value: null\r\n                }\r\n            } else {\r\n                //否则成功返回\r\n                return {\r\n                    message: \"成功读取\",\r\n                    value: data.value\r\n                }\r\n            }\r\n        }\r\n        return {\r\n            message: '值无效',\r\n            value: null\r\n        }\r\n    }\r\n    //设置localStorage和过期时间\r\n    set<T>(key: Str, value: T, expire: Expire = Dictionaries.permanent) {\r\n        //格式化数据\r\n        const data: Date<T> = {\r\n            value,\r\n            [Dictionaries.expire]: expire\r\n        }\r\n        localStorage.setItem(key, JSON.stringify(data));\r\n\r\n    }\r\n    //删除\r\n    remove(key: Str) {\r\n        localStorage.removeItem(key);\r\n    }\r\n    //清除\r\n    clear() {\r\n        localStorage.clear()\r\n    }\r\n}\r\n\r\n\r\n"],"names":["Dictionaries","Storage","get","key","value","localStorage","getItem","data","JSON","parse","now","Date","getTime","expire","this","remove","message","set","permanent","setItem","stringify","removeItem","clear"],"mappings":"AAEA,IAAYA,GAAZ,SAAYA,GACRA,EAAA,OAAA,aACAA,EAAA,UAAA,WACH,CAHD,CAAYA,IAAAA,EAGX,CAAA,UCFYC,EAETC,IAAOC,GACH,MAAMC,EAAQC,aAAaC,QAAQH,GACnC,GAAIC,EAAO,CACP,MAAMG,EAAgBC,KAAKC,MAAML,GAC3BM,GAAM,IAAIC,MAAOC,UAEvB,MAAwC,iBAA7BL,EAAKP,EAAaa,SAAuBN,EAAKP,EAAaa,QAAUH,GAC5EI,KAAKC,OAAOZ,GACL,CACHa,QAAS,KAAKb,OACdC,MAAO,OAIJ,CACHY,QAAS,OACTZ,MAAOG,EAAKH,MAGvB,CACD,MAAO,CACHY,QAAS,MACTZ,MAAO,KAEd,CAEDa,IAAOd,EAAUC,EAAUS,EAAiBb,EAAakB,WAErD,MAAMX,EAAgB,CAClBH,QACA,CAACJ,EAAaa,QAASA,GAE3BR,aAAac,QAAQhB,EAAKK,KAAKY,UAAUb,GAE5C,CAEDQ,OAAOZ,GACHE,aAAagB,WAAWlB,EAC3B,CAEDmB,QACIjB,aAAaiB,OAChB"}